# Pre-filter task for lightweight filtering - only hard, objective rejection criteria
pre_filter_task:
  description: >
    Apply ONLY these HARD, OBJECTIVE rejection rules:
    - Reject if highest_salary is provided AND highest_salary < 180000
    - Reject if date_posted is older than 21 days

    CRITICAL NOTES:
    - highest_salary refers to the structured database field max_amount
    - Do NOT search the job description text for salary mentions
    - If highest_salary is NULL/missing, PASS the job through to the specialist agents
    - Compensation Philosophy and Trajectory & Mastery specialists will evaluate missing salary cases
    - Do NOT reject based on title, seniority, or location preferences - these are handled by specialists
    - Only apply the two objective rules above, nothing else


  expected_output: PreFilterResult
  agent: pre_filter_agent


# Specialized Brand Dimension Tasks - run in parallel for efficiency

north_star_task:
  description: >
    Evaluate job alignment with the candidate's North Star & Vision using built-in knowledge access.

    Your knowledge base contains the most recent career brand information filtered to north_star_vision content.
    Use this knowledge to analyze how well this job opportunity aligns with the candidate's vision,
    purpose, and long-term career direction.

    IMPORTANT: If critical job details are missing (responsibilities, role scope, growth opportunities),
    assign score=2 (significant hesitation) and note "insufficient data to assess alignment" in summary.
    Do NOT fabricate details or make assumptions about missing information.

    Use CONCRETE TIERS with specific criteria:
    - 1: Critical mismatch (fundamental incompatibility, deal-breaker)
    - 2: Significant hesitation (major concerns that could impact decision OR insufficient data)
    - 3: Acceptable (some alignment issues but workable fundamentals)
    - 4: Good match (solid alignment with positive signals)
    - 5: Exceptional fit (outstanding alignment, rare ideal match)

  expected_output: BrandDimensionAnalysis
  agent: north_star_matcher
  async_execution: true

trajectory_mastery_task:
  description: >
    Evaluate job alignment with the candidate's Trajectory & Mastery using built-in knowledge access.

    Your knowledge base contains the most recent career brand information filtered to trajectory_mastery content.
    Use this knowledge to analyze how well this job opportunity supports skill development and career growth.

    IMPORTANT: If job description lacks technical depth, skill requirements, or growth path details,
    assign score=2 (significant hesitation) and note "insufficient technical detail" in summary.
    Do NOT fabricate details or make assumptions about missing information.

    Use CONCRETE TIERS with specific criteria:
    - 1: Critical mismatch (role prevents required skill development, career regression)
    - 2: Significant hesitation (limited learning opportunities, wrong growth direction, OR insufficient data)
    - 3: Acceptable (some skill overlap but minimal growth potential)
    - 4: Good match (solid skill utilization with learning opportunities)
    - 5: Exceptional fit (perfect skill alignment and accelerated growth trajectory)

  expected_output: BrandDimensionAnalysis
  agent: trajectory_mastery_matcher
  async_execution: true

values_compass_task:
  description: >
    Evaluate job alignment with the candidate's Values Compass using built-in knowledge access.

    Your knowledge base contains the most recent career brand information filtered to values_compass content.
    Use this knowledge to analyze cultural alignment with core principles and work style preferences.

    Use CONCRETE TIERS with specific criteria:
    - 1: Critical mismatch (toxic environment conflict with deal-breaker values)
    - 2: Significant hesitation (multiple value conflicts or style incompatibility)
    - 3: Acceptable (minor value differences that don't impede core work)
    - 4: Good match (comfortable cultural alignment with positive signals)
    - 5: Exceptional fit (perfect cultural match with inspiring environment)

  expected_output: BrandDimensionAnalysis
  agent: values_compass_matcher
  async_execution: true

lifestyle_alignment_task:
  description: >
    Evaluate job alignment with the candidate's Lifestyle Alignment using built-in knowledge access.

    Your knowledge base contains the most recent career brand information filtered to lifestyle_alignment content.
    Use this knowledge to analyze work-life balance, location requirements, and personal commitments.

    Use CONCRETE TIERS with specific criteria:
    - 1: Critical mismatch (incompatible work situation vs. family needs/geography)
    - 2: Significant hesitation (major travel/remote issues that strain commitments)
    - 3: Acceptable (manageable arrangement with some flexibility trade-offs)
    - 4: Good match (comfortable work-life balance with positive arrangement signals)
    - 5: Exceptional fit (perfect location/remote setup with excellent work-life support)

  expected_output: BrandDimensionAnalysis
  agent: lifestyle_alignment_matcher
  async_execution: true

compensation_philosophy_task:
  description: >
    Evaluate job alignment with the candidate's Compensation Philosophy using built-in knowledge access.

    Your knowledge base contains the most recent career brand information filtered to compensation_philosophy content.
    Use this knowledge to analyze financial alignment with salary floors, equity preferences, and expectations.

    Use CONCRETE TIERS with specific criteria:
    - 1: Critical mismatch (far below salary floor with unacceptable equity)
    - 2: Significant hesitation (below floor or inappropriate stage/terms)
    - 3: Acceptable (meets floor but may have wanted stage/equity preferences)
    - 4: Good match (solid financials with positive equity/stage signals)
    - 5: Exceptional fit (perfect compensation alignment with excellent equity terms)

  expected_output: BrandDimensionAnalysis
  agent: compensation_philosophy_matcher
  async_execution: true

purpose_impact_task:
  description: >
    Evaluate job alignment with the candidate's Purpose & Impact using built-in knowledge access.

    Your knowledge base contains the most recent career brand information filtered to purpose_impact content.
    Use this knowledge to analyze mission alignment with "making the world better" through societal contribution.

    NOTE: Your evaluation can influence recommendations but does NOT serve as an absolute veto - provide contextual insight.

    Use CONCRETE TIERS with specific criteria:
    - 1: Critical mismatch (mission fundamentally opposed to societal betterment)
    - 2: Significant hesitation (neutral or slightly misaligned with impact goals)
    - 3: Acceptable (partial alignment but not core mission focus)
    - 4: Good match (meaningful impact potential with positive societal contribution)
    - 5: Exceptional fit (perfect alignment with major world-betterment impact)

  expected_output: BrandDimensionAnalysis
  agent: purpose_impact_matcher
  async_execution: true

industry_focus_task:
  description: >
    Evaluate job alignment with the candidate's Industry Focus using built-in knowledge access.

    Your knowledge base contains the most recent career brand information filtered to industry_focus content.
    Use this knowledge to analyze sector alignment with preferred domains (Healthcare, EdTech, Productivity, FinTech).

    NOTE: This evaluation has VERY LOW PRIORITY - provide context but don't expect it to drive major decisions.

    Use CONCRETE TIERS with specific criteria:
    - 1: Critical mismatch (opposes preferred sectors or enters strongly avoided industries)
    - 2: Significant hesitation (neutral industry with weak sector alignment)
    - 3: Acceptable (some tangential relevance but not preferred focus)
    - 4: Good match (decent industry alignment with positive sector signals)
    - 5: Exceptional fit (perfect alignment with top-preferred industry sectors)

  expected_output: BrandDimensionAnalysis
  agent: industry_focus_matcher
  async_execution: true

company_filters_task:
  description: >
    Evaluate job alignment with the candidate's Company Filters using built-in knowledge access.

    Your knowledge base contains the most recent career brand information filtered to company_filters content.
    Use this knowledge to analyze organizational culture with preferred company types and avoid criteria.

    NOTE: This evaluation has VERY LOW PRIORITY - provide minimal context only.

    Use CONCRETE TIERS with specific criteria:
    - 1: Critical mismatch (clearly matches avoided company types like PE flips or extractive industries)
    - 2: Significant hesitation (potentially problematic culture but not clearly violating)
    - 3: Acceptable (neutral culture without strong signals either way)
    - 4: Good match (some alignment with preferred cultures like growth-stage transparent execs)
    - 5: Exceptional fit (perfect company culture match with exciting organizational signals)

  expected_output: BrandDimensionAnalysis
  agent: company_filters_matcher
  async_execution: true

constraints_task:
  description: >
    Evaluate job compliance with the candidate's Constraints using built-in knowledge access.

    Your knowledge base contains the most recent career brand information filtered to constraints content.
    Use this knowledge to identify CRITICAL CONSTRAINTS that CAN SERVE AS ABSOLUTE VETOS.

    IMPORTANT: If critical constraint information is MISSING from job posting (location/remote policy,
    work authorization requirements, start date, manager culture), treat as score=2 and flag in constraint_issues.
    List what's missing: "Missing: location policy, work authorization requirements" etc.

    Use CONCRETE TIERS with specific criteria:
    - 1: Critical mismatch (violates deal-breakers: toxic cultures, founder micromanagement, geography, citizenship)
    - 2: Significant hesitation (multiple constraint concerns, potential work authorization issues, OR missing critical info)
    - 3: Acceptable (one minor constraint issue but largely compliant)
    - 4: Good match (fully compliant with positive availability signals)
    - 5: Exceptional fit (perfect compliance plus exciting timing/availability factors)

    If any constraints are violated, clearly flag the deal-breaker in constraint_issues.
    This evaluation has HIGH PRIORITY - constraint violations override all positive signals.

  expected_output: ConstraintsAnalysis
  agent: constraints_matcher
  async_execution: true

# Manager task that SYNTHESIZES specialist results
brand_match_task:
  description: >
    SYNTHESIS TASK: You receive results from 9 specialist agents AS CONTEXT plus a pre-calculated overall_alignment_score.

    Your job is to:
    1. VERIFY you have all 9 specialist results as context
    2. APPLY constraint veto (if constraints score ≤ 2, recommend=false)
    3. DETERMINE confidence level based on the overall_alignment_score range
    4. WRITE a comprehensive summary explaining the recommendations
    5. OUTPUT the complete final assessment

    The overall_alignment_score calculation and recommendation thresholds are handled by the system.

    CONSTRAINT VETO: If constraints violated, override to recommend=false regardless of score.
  expected_output: BrandMatchComplete
  agent: brand_match_manager
  # Context handled in Python for reliability
